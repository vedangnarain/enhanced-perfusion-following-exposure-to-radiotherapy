# Enhanced perfusion following exposure to radiotherapy: a theoretical investigation

An archive of code used to generate simulations and figures for the submitted paper ['Enhanced perfusion following exposure to radiotherapy: a theoretical investigation'](https://www.biorxiv.org/content/10.1101/2023.06.12.544532v1).

## Simulations

- Simulations were generated using [Microvessel Chaste](https://jmsgrogan.github.io/MicrovesselChaste/), an add-on to [Chaste](http://www.cs.ox.ac.uk/chaste/).
- To run the code, follow the installation instructions [here](https://jmsgrogan.github.io/MicrovesselChaste/) but use the `MicrovesselChaste` folder from this repo instead.  
- The simulations in this paper were generated by the file `MicrovesselChaste/test/simulation/flow/TestHaematocritSolvers.hpp`.

## Data

- The simulation data can be found in the directory `Results`. The folders are will need to be uncompressed before they can be read by the scripts.
- For the experimental data, see the [manuscript](www.biorxiv.org/content/10.1101/2023.06.12.544532v1) and this [repository](https://zenodo.org/record/8011700).

## Analysis

The Python files used to analyse the simulation data and produce figures can be found in the directory `Scripts`.

- All metrics for the forking network are generated by `calculate_nonrandom_forking_metrics_individual_killing.py`
- All metrics for the hexagonal network are generated by `calculate_hex_metrics_individual_killing.py`
- All functions (including TDA analysis) are defined in `get_paraview_data.py`
- For the TDA function alone, see `TDA/Script.py`
- Diameter distributions for the hexagonal network are generated by `generate_hexagonal_radii_distributions.py`

## Note

In the code, 'PQ' refers to the _perfusion quotient_, which is synonymous with 'PF' (the _perfusion fraction_).

## Citation

Enhanced perfusion following exposure to radiotherapy: a theoretical investigation
Jakub KÃ¶ry, Vedang Narain, Bernadette J. Stolz, Jakob Kaeppler, Bostjan Markelc, Ruth J. Muschel, Philip K. Maini, Joe M. Pitt-Francis, Helen M. Byrne
bioRxiv 2023.06.12.544532; doi: https://doi.org/10.1101/2023.06.12.544532
